<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ユーザー登録</title>
</head>
<body>
    <h1>ユーザー登録</h1>

    <!-- ユーザー登録フォーム -->
    <form action="/user/register/confirm" method="post" th:object="${userProfileDto}">
        <!-- CSRFトークン -->
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

        <!-- ユーザー名 -->
        <label for="username">ユーザー名:</label>
        <input type="text" id="username" th:field="*{username}" maxlength="100" required />
        <div th:if="${#fields.hasErrors('username')}" th:errors="*{username}" style="color: red;"></div>
        <br>

        <!-- パスワード -->
        <label for="password">パスワード:</label>
        <input type="password" id="password" th:field="*{password}" minlength="4" required />
        <div th:if="${#fields.hasErrors('password')}" th:errors="*{password}" style="color: red;"></div>
        <br>

        <!-- 姓 -->
        <label for="firstName">姓:</label>
        <input type="text" id="firstName" th:field="*{firstName}" required />
        <div th:if="${#fields.hasErrors('firstName')}" th:errors="*{firstName}" style="color: red;"></div>
        <br>

        <!-- 名 -->
        <label for="lastName">名:</label>
        <input type="text" id="lastName" th:field="*{lastName}" required />
        <div th:if="${#fields.hasErrors('lastName')}" th:errors="*{lastName}" style="color: red;"></div>
        <br>

        <!-- ユーザーロール -->
        <label for="role">ユーザーロール:</label>
        <select id="role" th:field="*{role}" required>
            <option value="">選択してください</option>
            <option value="ADMIN">管理者</option>
            <option value="USER">一般ユーザー</option>
        </select>
        <div th:if="${#fields.hasErrors('role')}" th:errors="*{role}" style="color: red;"></div>
        <br>

        <!-- 生年月日 -->
        <label for="birthDate">生年月日:</label>
        <input type="date" id="birthDate" th:field="*{birthDate}" />
        <div th:if="${#fields.hasErrors('birthDate')}" th:errors="*{birthDate}" style="color: red;"></div>
        <br>

        <!-- 性別 -->
        <label for="gender">性別:</label>
        <select id="gender" th:field="*{gender}">
            <option value="male">男性</option>
            <option value="female">女性</option>
        </select>
        <div th:if="${#fields.hasErrors('gender')}" th:errors="*{gender}" style="color: red;"></div>
        <br>

        <!-- 雇用形態 -->
        <label for="employmentType">雇用形態:</label>
        <select id="employmentType" th:field="*{employmentType}" onchange="togglePartTimeFields()">
            <option value="fulltime">正社員</option>
            <option value="parttime">パート</option>
        </select>
		
		<div id="partTimeFields" style="display: none; margin-top: 1em;">
		    <h4>固定勤務スケジュール（曜日ごとの時間）</h4>

		    <!-- 月曜日 -->
		    <label>月曜日：</label>
		    <input type="checkbox" id="mondayOff" th:field="*{mondayOff}" onchange="toggleWorkTime('monday')" />
		    <span>休み</span>
		    <select id="mondayStartTime" th:field="*{mondayStartTime}">
		        <option value="">--開始--</option>
		        <option th:each="t : ${timeOptions}" th:value="${t}" th:text="${t}"></option>
		    </select>
		    〜
		    <select id="mondayEndTime" th:field="*{mondayEndTime}">
		        <option value="">--終了--</option>
		        <option th:each="t : ${timeOptions}" th:value="${t}" th:text="${t}"></option>
		    </select>
		    <br>

		    <!-- 火曜日 -->
		    <label>火曜日：</label>
		    <input type="checkbox" id="tuesdayOff" th:field="*{tuesdayOff}" onchange="toggleWorkTime('tuesday')" />
		    <span>休み</span>
		    <select id="tuesdayStartTime" th:field="*{tuesdayStartTime}">
		        <option value="">--開始--</option>
		        <option th:each="t : ${timeOptions}" th:value="${t}" th:text="${t}"></option>
		    </select>
		    〜
		    <select id="tuesdayEndTime" th:field="*{tuesdayEndTime}">
		        <option value="">--終了--</option>
		        <option th:each="t : ${timeOptions}" th:value="${t}" th:text="${t}"></option>
		    </select>
		    <br>

		    <!-- 水曜日 -->
		    <label>水曜日：</label>
		    <input type="checkbox" id="wednesdayOff" th:field="*{wednesdayOff}" onchange="toggleWorkTime('wednesday')" />
		    <span>休み</span>
		    <select id="wednesdayStartTime" th:field="*{wednesdayStartTime}">
		        <option value="">--開始--</option>
		        <option th:each="t : ${timeOptions}" th:value="${t}" th:text="${t}"></option>
		    </select>
		    〜
		    <select id="wednesdayEndTime" th:field="*{wednesdayEndTime}">
		        <option value="">--終了--</option>
		        <option th:each="t : ${timeOptions}" th:value="${t}" th:text="${t}"></option>
		    </select>
		    <br>

		    <!-- 木曜日 -->
		    <label>木曜日：</label>
		    <input type="checkbox" id="thursdayOff" th:field="*{thursdayOff}" onchange="toggleWorkTime('thursday')" />
		    <span>休み</span>
		    <select id="thursdayStartTime" th:field="*{thursdayStartTime}">
		        <option value="">--開始--</option>
		        <option th:each="t : ${timeOptions}" th:value="${t}" th:text="${t}"></option>
		    </select>
		    〜
		    <select id="thursdayEndTime" th:field="*{thursdayEndTime}">
		        <option value="">--終了--</option>
		        <option th:each="t : ${timeOptions}" th:value="${t}" th:text="${t}"></option>
		    </select>
		    <br>

		    <!-- 金曜日 -->
		    <label>金曜日：</label>
		    <input type="checkbox" id="fridayOff" th:field="*{fridayOff}" onchange="toggleWorkTime('friday')" />
		    <span>休み</span>
		    <select id="fridayStartTime" th:field="*{fridayStartTime}">
		        <option value="">--開始--</option>
		        <option th:each="t : ${timeOptions}" th:value="${t}" th:text="${t}"></option>
		    </select>
		    〜
		    <select id="fridayEndTime" th:field="*{fridayEndTime}">
		        <option value="">--終了--</option>
		        <option th:each="t : ${timeOptions}" th:value="${t}" th:text="${t}"></option>
		    </select>
		    <br>

		    <!-- 土曜日 -->
		    <label>土曜日：</label>
		    <input type="checkbox" id="saturdayOff" th:field="*{saturdayOff}" onchange="toggleWorkTime('saturday')" />
		    <span>休み</span>
		    <select id="saturdayStartTime" th:field="*{saturdayStartTime}">
		        <option value="">--開始--</option>
		        <option th:each="t : ${timeOptions}" th:value="${t}" th:text="${t}"></option>
		    </select>
		    〜
		    <select id="saturdayEndTime" th:field="*{saturdayEndTime}">
		        <option value="">--終了--</option>
		        <option th:each="t : ${timeOptions}" th:value="${t}" th:text="${t}"></option>
		    </select>
		    <br>

		    <!-- 日曜日 -->
		    <label>日曜日：</label>
		    <input type="checkbox" id="sundayOff" th:field="*{sundayOff}" onchange="toggleWorkTime('sunday')" />
		    <span>休み</span>
		    <select id="sundayStartTime" th:field="*{sundayStartTime}">
		        <option value="">--開始--</option>
		        <option th:each="t : ${timeOptions}" th:value="${t}" th:text="${t}"></option>
		    </select>
		    〜
		    <select id="sundayEndTime" th:field="*{sundayEndTime}">
		        <option value="">--終了--</option>
		        <option th:each="t : ${timeOptions}" th:value="${t}" th:text="${t}"></option>
		    </select>
		    <br>
		</div>

		<div th:if="${#fields.hasErrors('employmentType')}" th:errors="*{employmentType}" style="color: red;"></div>
        <br>

        <!-- 所属 -->
        <label for="department">所属:</label>
        <select id="department" th:field="*{department}">
            <option value="amami">天美</option>
            <option value="main">本社</option>
        </select>
        <div th:if="${#fields.hasErrors('department')}" th:errors="*{department}" style="color: red;"></div>
        <br>

        <!-- ボタン -->
        <button type="submit">確認</button>
        <button type="button" onclick="location.href='/'">戻る</button>
    </form>
	
	<script>
	function togglePartTimeFields() {
	    const selected = document.getElementById("employmentType").value;
	    const partFields = document.getElementById("partTimeFields");
	    partFields.style.display = (selected === "parttime") ? "block" : "none";
	}

	function toggleWorkTime(day) {
	    const isOff = document.getElementById(`${day}Off`).checked;
	    const start = document.getElementById(`${day}StartTime`);
	    const end = document.getElementById(`${day}EndTime`);
	    start.disabled = isOff;
	    end.disabled = isOff;
	    if (isOff) {
	        start.value = "";
	        end.value = "";
	    }
	}

	window.onload = function() {
	    togglePartTimeFields();
	    const days = ["monday", "tuesday", "wednesday", "thursday", "friday", "saturday", "sunday"];
	    days.forEach(day => toggleWorkTime(day));
	};
	</script>

</body>
</html>
